<div class="categories-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <h1>Categories</h1>
      <p>Manage content categories and organization</p>
    </div>
    @if (canCreateCategory()) {
      <div class="header-actions">
        <button class="btn btn-primary" (click)="onCreateCategory()">
          <i class="fas fa-plus"></i>
          Add Category
        </button>
      </div>
    }
  </div>

  <!-- Filters Section -->
  <div class="filters-section">
    <form [formGroup]="filterForm" class="filters-form">
      <div class="filter-group">
        <label for="search">Search Categories</label>
        <input
          type="text"
          id="search"
          formControlName="search"
          class="form-control"
          placeholder="Search by name or description..."
        >
      </div>
      
      <div class="filter-actions">
        <button type="button" class="btn btn-secondary" (click)="clearFilters()">
          <i class="fas fa-times"></i>
          Clear
        </button>
      </div>
    </form>
  </div>

  <!-- Categories List -->
  <div class="categories-list">
    <!-- Loading State -->
    @if (loading()) {
      <div class="loading-state">
        <div class="spinner"></div>
        <p>Loading categories...</p>
      </div>
    }

    <!-- Error State -->
    @if (error() && !loading()) {
      <div class="error-state">
        <i class="fas fa-exclamation-triangle"></i>
        <p>{{ error() }}</p>
        <button class="btn btn-primary" (click)="loadCategories()">
          <i class="fas fa-refresh"></i>
          Try Again
        </button>
      </div>
    }

    <!-- Empty State -->
    @if (!loading() && !error() && categories().length === 0) {
      <div class="empty-state">
        <div class="empty-icon">
          <i class="fas fa-tags"></i>
        </div>
        <h3>No Categories Found</h3>
        <p>Get started by creating your first category.</p>
        @if (canCreateCategory()) {
          <button class="btn btn-primary" (click)="onCreateCategory()">
            <i class="fas fa-plus"></i>
            Create First Category
          </button>
        }
      </div>
    }

    <!-- Categories Table -->
    @if (!loading() && !error() && categories().length > 0) {
      <div class="categories-table-container">
        <table class="categories-table">
          <thead>
            <tr>
              <th>Category</th>
              <th>Description</th>
              <th>Slug</th>
              <th>Created</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            @for (category of categories(); track category._id) {
              <tr class="category-row">
                <td class="category-name">
                  <div class="name-content">
                    <h4>{{ category.name }}</h4>
                  </div>
                </td>
                <td class="category-description">
                  @if (category.description) {
                    <p>{{ category.description }}</p>
                  } @else {
                    <span class="text-muted">No description</span>
                  }
                </td>
                <td class="category-slug">
                  <code>{{ category.slug }}</code>
                </td>
                <td class="category-date">
                  {{ formatDate(category.createdAt) }}
                </td>
                <td class="category-actions">
                  <div class="action-buttons">
                    <button 
                      class="btn btn-sm btn-info"
                      (click)="onViewCategory(category)"
                      title="View Category"
                    >
                      <i class="fas fa-eye"></i>
                    </button>
                    @if (canEditCategory()) {
                      <button 
                        class="btn btn-sm btn-warning"
                        (click)="onEditCategory(category)"
                        title="Edit Category"
                      >
                        <i class="fas fa-edit"></i>
                      </button>
                    }
                    @if (canDeleteCategory()) {
                      <button 
                        class="btn btn-sm btn-danger"
                        (click)="onDeleteCategory(category)"
                        title="Delete Category"
                      >
                        <i class="fas fa-trash"></i>
                      </button>
                    }
                  </div>
                </td>
              </tr>
            }
          </tbody>
        </table>

        <!-- Pagination -->
        @if (totalPages() > 1) {
          <div class="pagination-container">
            <div class="pagination-info">
              Showing {{ (currentPage() - 1) * pageSize() + 1 }} to {{ maxPage() }} of {{ totalCategories() }} categories
            </div>
            
            <div class="pagination-nav">
              <button 
                class="btn btn-pagination"
                (click)="onPageChange(currentPage() - 1)"
                [disabled]="currentPage() === 1"
              >
                <i class="fas fa-chevron-left"></i>
                Previous
              </button>

              <div class="page-numbers">
                @for (page of paginationNumbers(); track page) {
                  <button 
                    class="btn btn-page"
                    [class.active]="page === currentPage()"
                    [class.dots]="page === -1"
                    (click)="page !== -1 && onPageChange(page)"
                    [disabled]="page === -1"
                  >
                    {{ page === -1 ? '...' : page }}
                  </button>
                }
              </div>

              <button 
                class="btn btn-pagination"
                (click)="onPageChange(currentPage() + 1)"
                [disabled]="currentPage() === totalPages()"
              >
                Next
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
        }
      </div>
    }
  </div>
</div>
