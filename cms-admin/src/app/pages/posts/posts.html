<div class="posts-container">
  <div class="page-header">
    <div class="header-content">
      <h1>Posts Management</h1>
      <p>Create, edit, and manage your blog posts</p>
    </div>
    <div class="header-actions" *ngIf="canCreatePost()">
      <button class="btn btn-primary" (click)="onCreatePost()">
        <i class="fas fa-plus"></i>
        Create New Post
      </button>
    </div>
  </div>

  <!-- Filters Section -->
  <div class="filters-section">
    <form [formGroup]="filterForm" class="filters-form">
      <div class="filter-group">
        <label for="search">Search</label>
        <input
          type="text"
          id="search"
          formControlName="search"
          placeholder="Search posts by title, content..."
          class="form-control"
        >
      </div>

      <div class="filter-group">
        <label for="status">Status</label>
        <select id="status" formControlName="status" class="form-control">
          <option *ngFor="let option of statusOptions" [value]="option.value">
            {{ option.label }}
          </option>
        </select>
      </div>

      <div class="filter-group">
        <label for="author">Author ID</label>
        <input
          type="text"
          id="author"
          formControlName="author"
          placeholder="Filter by author ID..."
          class="form-control"
        >
      </div>

      <div class="filter-actions">
        <button type="button" class="btn btn-secondary" (click)="clearFilters()">
          Clear Filters
        </button>
      </div>
    </form>
  </div>

  <!-- Posts List -->
  <div class="posts-list">
    @if (loading) {
    <div  class="loading-state">
      <div class="spinner"></div>
        <p>Loading posts...</p>
    </div>
    } @else {
    <!-- <div *ngIf="error" class="error-state">
      <p>{{ error }}</p>
      <button class="btn btn-primary" (click)="loadPosts()">Try Again</button>
    </div> -->

    <!-- <div *ngIf="!loading && !error && posts.length === 0" class="empty-state">
      <div class="empty-icon">
        <i class="fas fa-file-alt"></i>
      </div>
      <h3>No posts found</h3>
      <p>Start by creating your first blog post</p>
      <button *ngIf="canCreatePost()" class="btn btn-primary" (click)="onCreatePost()">
        Create Your First Post
      </button>
    </div> -->

    <div  class="posts-table-container">
      <table class="posts-table">
        <thead>
          <tr>
            <th>Title</th>
            <th>Status</th>
            <th>Category</th>
            <th>Placement</th>
            <th>Created</th>
            <th>Expires On</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
            @for (post of posts(); track $index) {
          <tr >
            <td class="post-title">
              <div class="title-content">
                <h4>{{ post.title }}</h4>
                <p *ngIf="post.excerpt">{{ post.excerpt }}</p>
                <div class="post-meta">
                  <span class="slug">{{ post.slug }}</span>
                  <span *ngIf="post.tags && post.tags.length" class="tags">
                    <i class="fas fa-tags"></i>
                    {{ post.tags.join(', ') }}
                  </span>
                </div>
              </div>
            </td>
            <td>
              <span class="badge" [ngClass]="getStatusBadgeClass(post.status)">
                {{ post.status | titlecase }}
              </span>
            </td>
            <td>
              <span class="category-name">
                {{ getCategoryName(post.category) }}
              </span>
            </td>
            <td>
              <span class="placement-name">
                {{ getPlacementName(post.placement) }}
              </span>
            </td>
            <td>{{ formatDate(post.createdAt) }}</td>
            <td>
              <span class="expired-date" [ngClass]="getExpiredDateClass(post.expiredAt)">
                {{ formatDate(post.expiredAt) }}
              </span>
            </td>
            <td>
              <div class="action-buttons">
                <button
                  class="btn btn-sm btn-info"
                  (click)="onEditPost(post)"
                  title="Edit Post"
                >
                  <i class="bi bi-pencil"></i>
                </button>
                <button
                  *ngIf="canDeletePost(post)"
                  class="btn btn-sm btn-danger"
                  (click)="onDeletePost(post)"
                  title="Delete Post"
                >
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        }
        </tbody>
      </table>
    </div>

    }

    <!-- Pagination -->
    <div *ngIf="!loading && !error && totalPages > 1" class="pagination-container">
      <div class="pagination-info">
        Showing {{ (currentPage - 1) * pageSize + 1 }} to {{ getMaxPage() }} of {{ totalPosts }} posts
      </div>

      <nav class="pagination-nav">
        <button
          class="btn btn-pagination"
          [disabled]="currentPage === 1"
          (click)="onPageChange(currentPage - 1)"
        >
          <i class="fas fa-chevron-left"></i>
          Previous
        </button>

        <div class="page-numbers">
          <button
            *ngFor="let page of getPaginationNumbers()"
            class="btn btn-page"
            [ngClass]="{ 'active': page === currentPage, 'dots': page === -1 }"
            [disabled]="page === -1"
            (click)="page !== -1 && onPageChange(page)"
          >
            {{ page === -1 ? '...' : page }}
          </button>
        </div>

        <button
          class="btn btn-pagination"
          [disabled]="currentPage === totalPages"
          (click)="onPageChange(currentPage + 1)"
        >
          Next
          <i class="fas fa-chevron-right"></i>
        </button>
      </nav>
    </div>
  </div>
</div>
